---
dir: miaosha
title: 秒杀整体解决方案
date: 2022-11-06 22:03:52
tags: [面试]
categories: 项目
---

秒杀场景一般会在电商网站举行一些活动或者节假日在12306网站上抢票时遇到。对于电商网站中一些稀缺或者特 价商品，电商网站一般会在约定时间点对其进行限量销售，因为这些商品的特殊性，会吸引大量用户前来抢购，并 且会在约定的时间点同时在秒杀页面进行抢购。此种场景就是非常有特点的高并发场景，如果不对流量进行合理管控，肆意放任大流量冲击系统，那么将导致一系 列的问题出现，比如一些可用的连接资源被耗尽、分布式缓存的容量被撑爆、数据库吞吐量降低，最终必然会导致系统产生雪崩效应。

<!--more-->

1. 客户端。

2. dns。A记录（Address）：将域名和IP做对应。 一个域名对应多个IP。负载均衡。

3. cdn。内容网络分发。（CNAME记录：域名到域名的映射。）| cdn缓存。

   动态数据

   静态数据：非个性化的数据。通用的 商品列表，商品详情。图片类等。

4. 网关（过滤器）/负载均衡。（鉴权，黑名单（redis（黑名单ip的字符串），if （字符串contains(客户端来源的ip)）），限流等）。

   确定黑名单：没有固定的办法，看业务。（10s 来 5次，就算黑名单。key=ip，value：1，incr）

5. 服务-api-xxx和服务-service-xxxx（）

6. 缓存（读多写少）。异步（缓存）

7. DB层：分区（对一个文件的操作，负载成对多个文件的操作），读写分离，分库分表。

   并发读，并发写。短时间内，大量请求。